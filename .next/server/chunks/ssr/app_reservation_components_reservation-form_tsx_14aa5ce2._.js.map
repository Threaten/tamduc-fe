{"version":3,"sources":["turbopack:///[project]/app/reservation/components/reservation-form.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  createPatient,\n  createReservation,\n  getPatient,\n} from \"@/lib/api/queries\";\nimport { useToast } from \"@/app/components/toast\";\nimport { useMemo, useState } from \"react\";\n\nconst genders = [\n  { value: \"\", label: \"Select gender (optional)\" },\n  { value: \"Male\", label: \"Male\" },\n  { value: \"Female\", label: \"Female\" },\n  { value: \"Other\", label: \"Other\" },\n];\n\nconst VN_PHONE = /^(?:\\+?84|0)(3|5|7|8|9)\\d{8}$/;\n\ntype Form = {\n  name: string;\n  phone: string;\n  email: string;\n  dob: string; // YYYY-MM-DD\n  gender: string;\n  date: string;\n  time: string;\n  symptoms: string;\n  department: string;\n};\n\n/**\n * Combine separate form date (YYYY-MM-DD) and time (HH:MM) strings\n * into a single Date object using the user's local timezone.\n * Also returns a \"local\" ISO-like string without converting to UTC\n * (so 2025-09-26 09:30 local stays 2025-09-26T09:30:00 for persistence if needed).\n */\nfunction combineDateAndTime(\n  dateStr: string,\n  timeStr: string\n): { date: Date; isoLocal: string } | null {\n  if (!dateStr || !timeStr) return null;\n  const dateParts = dateStr.split(\"-\").map(Number);\n  const timeParts = timeStr.split(\":\").map(Number);\n  if (dateParts.length !== 3 || timeParts.length < 2) return null;\n  const [y, m, d] = dateParts;\n  const [hh, mm] = timeParts;\n  if (\n    [y, m, d, hh, mm].some((n) => Number.isNaN(n)) ||\n    m < 1 ||\n    m > 12 ||\n    d < 1 ||\n    d > 31 ||\n    hh < 0 ||\n    hh > 23 ||\n    mm < 0 ||\n    mm > 59\n  ) {\n    return null;\n  }\n  const localDate = new Date(y, m - 1, d, hh, mm, 0, 0);\n  // Build a local ISO-like string without timezone shifting to UTC\n  const pad = (n: number) => n.toString().padStart(2, \"0\");\n  const isoLocal = `${y}-${pad(m)}-${pad(d)}T${pad(hh)}:${pad(mm)}:00`;\n  return { date: localDate, isoLocal };\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport function ReservationForm(departmentsProp: any) {\n  const departments = departmentsProp.departmentsProp;\n  const [form, setForm] = useState<Form>({\n    name: \"\",\n    phone: \"\",\n    email: \"\",\n    dob: \"\",\n    gender: \"\",\n    date: \"\",\n    time: \"\",\n    symptoms: \"\",\n    department: \"\",\n  });\n  const [submitting, setSubmitting] = useState(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [submitted, setSubmitted] = useState(false);\n  // Local (non-UTC-shifted) YYYY-MM-DD for comparisons & input constraints\n  const todayStr = useMemo(() => {\n    const d = new Date();\n    const pad = (n: number) => n.toString().padStart(2, \"0\");\n    return `${d.getFullYear()}-${pad(d.getMonth() + 1)}-${pad(d.getDate())}`;\n  }, []);\n\n  // Maximum booking horizon (e.g., 90 days from today)\n  const horizonStr = useMemo(() => {\n    const d = new Date();\n    d.setDate(d.getDate() + 90);\n    const pad = (n: number) => n.toString().padStart(2, \"0\");\n    return `${d.getFullYear()}-${pad(d.getMonth() + 1)}-${pad(d.getDate())}`;\n  }, []);\n\n  const LEAD_MINUTES = 30; // Minimum lead time buffer\n\n  const { push } = useToast();\n  // Validation logic aligned with contact form style\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]{2,}$/;\n  const validators: Record<\n    keyof Form,\n    (val: string, full?: Form) => string | null\n  > = {\n    name: (v) => {\n      const t = v.trim();\n      if (!t) return \"Full name is required\";\n      if (t.length < 2) return \"Name must be at least 2 characters\";\n      return null;\n    },\n    phone: (v) => {\n      const t = v.trim();\n      if (!t) return \"Phone is required\";\n      return VN_PHONE.test(t) ? null : \"Invalid Vietnamese phone\";\n    },\n    email: (v) => {\n      const t = v.trim();\n      if (!t) return \"\"; // optional\n      return emailRegex.test(t) ? null : \"Invalid email\";\n    },\n    dob: (v) => {\n      if (!v) return \"Date of birth is required\";\n      if (v >= todayStr) return \"DOB must be before today\";\n      return null;\n    },\n    gender: () => null, // optional\n    date: (v) => {\n      if (!v) return \"Date is required\";\n      if (v < todayStr) return \"Date must be today or later\";\n      if (v > horizonStr) return \"Date cannot be more than 90 days out\";\n      return null;\n    },\n    time: (v) => {\n      if (!v) return \"Time is required\";\n      return null; // combined datetime validation handled separately once both date & time exist\n    },\n    symptoms: (v) => (v.trim() ? null : \"Symptoms are required\"),\n    department: (v) => (v ? null : \"Department is required\"),\n  };\n\n  const validateField = (name: keyof Form, value: string, full: Form) => {\n    const fn = validators[name];\n    if (!fn) return;\n    const err = fn(value, full);\n    setErrors((prev) => {\n      if (err) return { ...prev, [name]: err };\n      const clone = { ...prev };\n      delete clone[name];\n      return clone;\n    });\n  };\n\n  const validateAll = (f: Form) => {\n    const newErr: Record<string, string> = {};\n    (Object.keys(f) as (keyof Form)[]).forEach((k) => {\n      const msg = validators[k](f[k], f);\n      if (msg) newErr[k] = msg;\n    });\n    // Combined date+time future & lead-time validation\n    if (!newErr.date && !newErr.time && f.date && f.time) {\n      const combined = combineDateAndTime(f.date, f.time);\n      if (!combined) {\n        newErr.time = \"Invalid date/time\";\n      } else {\n        const now = new Date();\n        const lead = new Date(now.getTime() + LEAD_MINUTES * 60 * 1000);\n        if (combined.date.getTime() <= lead.getTime()) {\n          newErr.time = `Appointment must be at least ${LEAD_MINUTES} minutes from now`;\n        }\n        // Horizon already enforced by date, but extra guard if user manipulated inputs\n        const horizonDate = combineDateAndTime(horizonStr, \"23:59\");\n        if (\n          horizonDate &&\n          combined.date.getTime() > horizonDate.date.getTime()\n        ) {\n          newErr.date = \"Appointment beyond allowed horizon\";\n        }\n      }\n    }\n    setErrors(newErr);\n    return Object.keys(newErr).length === 0;\n  };\n\n  let patient: string;\n\n  type Patient = {\n    id: string;\n    fullName: string;\n    phone: string;\n    email?: string;\n  };\n\n  const checkIfCustomerExisted = async (phone: string) => {\n    // Placeholder: integrate API call here.\n    const patientData = (await getPatient(`${phone}`)) as {\n      Patients: {\n        docs: Patient[];\n      };\n    };\n\n    if (!patientData.Patients.docs.length) {\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      const newPatient: any = await createPatient(\n        form.name,\n        form.phone,\n        form.email,\n        form.gender,\n        form.dob\n      ).catch((error) => {\n        console.error(\"Error creating patient:\", error);\n      });\n\n      patient = newPatient.createPatient.id;\n    } else {\n      patient = patientData.Patients.docs[0].id;\n    }\n    return patient;\n  };\n\n  async function onSubmit(ev: React.FormEvent) {\n    ev.preventDefault();\n    if (submitting) return;\n    // Final validation pass\n    if (!validateAll(form)) return;\n    const combined = combineDateAndTime(form.date, form.time);\n    // Debug log removed\n\n    if (!combined) {\n      setErrors((prev) => ({\n        ...prev,\n        time: prev.time || \"Invalid date/time\",\n      }));\n      return;\n    }\n    // Send combined.isoLocal as datetime to backend createReservation\n    setSubmitting(true);\n    await checkIfCustomerExisted(form.phone);\n    // Debug log removed\n\n    try {\n      await createReservation(\n        patient,\n        combined.isoLocal,\n        form.symptoms,\n        form.department\n      );\n      setSubmitted(true);\n      push(\"Reservation submitted\", \"success\");\n    } catch (err) {\n      console.error(err);\n      push(\"Failed to submit reservation\", \"error\");\n    } finally {\n      setSubmitting(false);\n    }\n  }\n\n  if (submitted) {\n    return (\n      <div className=\"mt-6 rounded-2xl border border-black/10 dark:border-white/10 p-6\">\n        <p className=\"text-sm\">Thank you, we’ve received your reservation.</p>\n      </div>\n    );\n  }\n\n  return (\n    <form\n      onSubmit={onSubmit}\n      className=\"mt-6 rounded-2xl border border-black/10 dark:border-white/10 p-6 space-y-4\"\n    >\n      <div>\n        <label className=\"block text-sm mb-1\">Full Name</label>\n        <input\n          className=\"w-full rounded-md border border-black/10 dark:border-white/10 bg-transparent px-3 py-2 text-sm\"\n          value={form.name}\n          onChange={(e) => {\n            const value = e.target.value;\n            setForm((prev) => ({ ...prev, name: value }));\n            validateField(\"name\", value, { ...form, name: value });\n          }}\n          placeholder=\"Nguyen Van A\"\n          required\n          aria-invalid={!!errors.name}\n        />\n        {errors.name && (\n          <p className=\"text-red-500 text-xs mt-1\">{errors.name}</p>\n        )}\n      </div>\n\n      <div>\n        <label className=\"block text-sm mb-1\">Phone (Vietnam)</label>\n        <input\n          className=\"w-full rounded-md border border-black/10 dark:border-white/10 bg-transparent px-3 py-2 text-sm\"\n          value={form.phone}\n          onChange={(e) => {\n            const value = e.target.value;\n            setForm((prev) => ({ ...prev, phone: value }));\n            validateField(\"phone\", value, { ...form, phone: value });\n          }}\n          placeholder=\"0xxxxxxxxx or +84xxxxxxxxx\"\n          required\n          aria-invalid={!!errors.phone}\n        />\n        {errors.phone && (\n          <p className=\"text-red-500 text-xs mt-1\">{errors.phone}</p>\n        )}\n      </div>\n\n      <div>\n        <label className=\"block text-sm mb-1\">Email</label>\n        <input\n          type=\"email\"\n          className=\"w-full rounded-md border border-black/10 dark:border-white/10 bg-transparent px-3 py-2 text-sm\"\n          value={form.email}\n          onChange={(e) => {\n            const value = e.target.value;\n            setForm((prev) => ({ ...prev, email: value }));\n            validateField(\"email\", value, { ...form, email: value });\n          }}\n          placeholder=\"you@example.com\"\n          aria-invalid={!!errors.email}\n        />\n        {errors.email && (\n          <p className=\"text-red-500 text-xs mt-1\">{errors.email}</p>\n        )}\n      </div>\n\n      <div className=\"grid sm:grid-cols-2 gap-4\">\n        <div>\n          <label className=\"block text-sm mb-1\">Date of Birth</label>\n          <input\n            type=\"date\"\n            max={todayStr} /* DOB capped at today */\n            className=\"w-full rounded-md border border-black/10 dark:border-white/10 bg-transparent px-3 py-2 text-sm\"\n            value={form.dob}\n            onChange={(e) => {\n              const value = e.target.value;\n              setForm((prev) => ({ ...prev, dob: value }));\n              validateField(\"dob\", value, { ...form, dob: value });\n            }}\n            required\n            aria-invalid={!!errors.dob}\n          />\n          {errors.dob && (\n            <p className=\"text-red-500 text-xs mt-1\">{errors.dob}</p>\n          )}\n        </div>\n        <div>\n          <label className=\"block text-sm mb-1\">Gender</label>\n          <div className=\"relative\">\n            <select\n              className=\"w-full appearance-none rounded-md border border-black/10 dark:border-white/10 bg-transparent backdrop-blur px-3 py-2 pr-8 text-sm leading-tight focus:outline-none focus:ring-2 focus:ring-black/20 dark:focus:ring-white/20 transition-colors\"\n              value={form.gender}\n              onChange={(e) => setForm({ ...form, gender: e.target.value })}\n            >\n              {genders.map((g) => (\n                <option\n                  key={g.value}\n                  value={g.value}\n                  className=\"bg-white dark:bg-black text-inherit\"\n                >\n                  {g.label}\n                </option>\n              ))}\n            </select>\n            <span className=\"pointer-events-none absolute inset-y-0 right-2 flex items-center text-xs opacity-60\">\n              ▾\n            </span>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"grid sm:grid-cols-2 gap-4\">\n        <div>\n          <label className=\"block text-sm mb-1\">Date</label>\n          <input\n            type=\"date\"\n            min={todayStr}\n            max={horizonStr}\n            className=\"w-full rounded-md border border-black/10 dark:border-white/10 bg-transparent px-3 py-2 text-sm\"\n            value={form.date}\n            onChange={(e) => {\n              const value = e.target.value;\n              setForm((prev) => ({ ...prev, date: value }));\n              validateField(\"date\", value, { ...form, date: value });\n              // If time already selected, re-run combined validation\n              if (form.time) validateAll({ ...form, date: value });\n            }}\n            required\n            aria-invalid={!!errors.date}\n          />\n          {errors.date && (\n            <p className=\"text-red-500 text-xs mt-1\">{errors.date}</p>\n          )}\n        </div>\n        <div>\n          <label className=\"block text-sm mb-1\">Time</label>\n          <input\n            type=\"time\"\n            className=\"w-full rounded-md border border-black/10 dark:border-white/10 bg-transparent px-3 py-2 text-sm\"\n            value={form.time}\n            onChange={(e) => {\n              const value = e.target.value;\n              setForm((prev) => ({ ...prev, time: value }));\n              validateField(\"time\", value, { ...form, time: value });\n              if (form.date) validateAll({ ...form, time: value });\n            }}\n            required\n            aria-invalid={!!errors.time}\n          />\n          {errors.time && (\n            <p className=\"text-red-500 text-xs mt-1\">{errors.time}</p>\n          )}\n        </div>\n      </div>\n\n      <div>\n        <label className=\"block text-sm mb-1\">Symptoms</label>\n        <textarea\n          rows={3}\n          className=\"w-full rounded-md border border-black/10 dark:border-white/10 bg-transparent px-3 py-2 text-sm\"\n          value={form.symptoms}\n          onChange={(e) => {\n            const value = e.target.value;\n            setForm((prev) => ({ ...prev, symptoms: value }));\n            validateField(\"symptoms\", value, { ...form, symptoms: value });\n          }}\n          placeholder=\"Describe your symptoms\"\n          required\n          aria-invalid={!!errors.symptoms}\n        />\n        {errors.symptoms && (\n          <p className=\"text-red-500 text-xs mt-1\">{errors.symptoms}</p>\n        )}\n      </div>\n\n      <div>\n        <label className=\"block text-sm mb-1\">Department</label>\n        <div className=\"relative\">\n          <select\n            className=\"w-full appearance-none rounded-md border border-black/10 dark:border-white/10 bg-transparent backdrop-blur px-3 py-2 pr-8 text-sm leading-tight focus:outline-none focus:ring-2 focus:ring-black/20 dark:focus:ring-white/20 transition-colors\"\n            value={form.department}\n            onChange={(e) => {\n              const value = e.target.value;\n              setForm((prev) => ({ ...prev, department: value }));\n              validateField(\"department\", value, {\n                ...form,\n                department: value,\n              });\n            }}\n            required\n            aria-invalid={!!errors.department}\n          >\n            <option value=\"\" disabled key=\"default\">\n              Select your option\n            </option>\n\n            {departments.map(\n              (d: { id: string; title: string; slug: string }) => (\n                <option\n                  key={d.slug}\n                  value={d.id}\n                  className=\"bg-white dark:bg-black text-inherit\"\n                >\n                  {d.title}\n                </option>\n              )\n            )}\n          </select>\n          <span className=\"pointer-events-none absolute inset-y-0 right-2 flex items-center text-xs opacity-60\">\n            ▾\n          </span>\n        </div>\n        {errors.department && (\n          <p className=\"text-red-500 text-xs mt-1\">{errors.department}</p>\n        )}\n      </div>\n\n      <div className=\"pt-2\">\n        <button\n          disabled={submitting}\n          className=\"rounded-full px-5 py-2 text-sm font-medium border border-black/10 dark:border-white/10 disabled:opacity-50\"\n        >\n          {submitting ? \"Submitting...\" : \"Reserve\"}\n        </button>\n      </div>\n    </form>\n  );\n}\n"],"names":[],"mappings":"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"}